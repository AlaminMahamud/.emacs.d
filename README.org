#+TITLE: Alamin's Emacs Configuration
#+AUTHOR: Md. Alamin Mahamud
#+EMAIL: alamin.ineedahelp@gmail.com

#+STARTUP: overview indent inlineimages
#+OPTIONS: H:5 num:nil tags:nil toc:nil timestamp:t
#+LAYOUT: post
#+DESCRIPTION: Loading Emacs Configuration using org-babel
#+TAGS: emacs
#+CATEGORIES: editing

* hide all unnecessary interfaces
#+BEGIN_SRC emacs-lisp
  (if
      (fboundp 'menu-bar-mode)
      (menu-bar-mode -1))

  (if
      (fboundp 'tool-bar-mode)
      (tool-bar-mode -1))

  (if
      (fboundp 'scroll-bar-mode)
      (scroll-bar-mode -1))

  (setq inhibit-startup-message t)
#+END_SRC

* global settings
** emacs-server
#+begin_src emacs-lisp
(server-start)
#+end_src
** replace yes wit y
#+begin_src emacs-lisp
(fset 'yes-or-no-p 'y-or-n-p)
#+end_src
** coding system :DRILL:
#+begin_src emacs-lisp
(set-terminal-coding-system 'utf-8)
(set-keyboard-coding-system 'utf-8)
(set-language-environment "UTF-8")
(prefer-coding-system 'utf-8)
(when (display-graphic-p)
  (setq x-select-request-type '(UTF8_STRING COMPOUND_TEXT TEXT STRING)))
#+end_src
* custom settings
#+BEGIN_SRC emacs-lisp
  (setq custom-file
        (expand-file-name "custom.el" user-emacs-directory))
  (load custom-file)
#+END_SRC
* package init
#+BEGIN_SRC emacs-lisp
  (require 'package)
  (setq package-archives nil)
  (setq package-archives
        '(
          ("org"       . "http://orgmode.org/elpa/")
          ("gnu"       . "http://elpa.gnu.org/packages/")
          ("melpa"     . "http://melpa.org/packages/")
          ("marmalade" . "http://marmalade-repo.org/packages/")))

  (package-initialize)
  (unless (and (file-exists-p "~/.emacs.d/elpa/archives/gnu")
               (file-exists-p "~/.emacs.d/elpa/archives/melpa")
               (file-exists-p "~/.emacs.d/elpa/archives/melpa-stable")
               (file-exists-p "~/.emacs.d/elpa/archives/marmalade")
               )
    (package-refresh-contents))

  ;; use-package
  (unless (package-installed-p 'use-package)
    (package-refresh-contents)
    (package-install 'use-package))

  (setq use-package-verbose t)
  (setq use-package-always-ensure t)
  (require 'use-package)
#+END_SRC
* elisp enhancement
#+BEGIN_SRC emacs-lisp
  (require 'cl)

  (use-package dash
    :config (eval-after-load "dash" '(dash-enable-font-lock)))

  (use-package s)

  (use-package f)
#+END_SRC
* appearance
** font-lock decoration
#+BEGIN_SRC emacs-lisp
  (setq font-lock-maximum-decoration t
        color-theme-is-global t
        truncate-partial-width-windows nil)
#+END_SRC

** visible-bell disable
#+BEGIN_SRC emacs-lisp
  (setq visible-bell nil)
  (setq ring-bell-function (lambda ()
                             (invert-face 'mode-line)
                             (run-with-timer 0.05 nil 'invert-face 'mode-line)))
#+END_SRC
** highlight current line
#+BEGIN_SRC emacs-lisp
  (global-hl-line-mode 1)
#+END_SRC
** show paren mode
#+BEGIN_SRC emacs-lisp
  (show-paren-mode 1)
#+END_SRC
** frame-title-format
#+BEGIN_SRC emacs-lisp
  (when window-system
    (setq frame-title-format '(buffer-file-name "%f" ("%b")))
    (tooltip-mode -1)
    (blink-cursor-mode -1)
    )
#+END_SRC
** arjen-grey-theme
#+BEGIN_SRC emacs-lisp
  (use-package arjen-grey-theme
    :config
    (load-theme 'arjen-grey t))
#+END_SRC
** all-the-icons
#+BEGIN_SRC emacs-lisp
  (use-package all-the-icons)
  (use-package all-the-icons-dired)
  (use-package pretty-mode)
#+END_SRC
** scratch buffer
#+BEGIN_SRC emacs-lisp
  (setq initial-scratch-message (concat ";; One Brick A Day, " user-login-name " - Emacs ♥ you!\n\n"))
#+END_SRC
** fonts
#+BEGIN_SRC emacs-lisp
  (if (or (eq system-type 'darwin)(eq system-type 'gnu/linux) )
  ;    (set-face-attribute 'default nil :font "Consolas-14")
  ;    (set-face-attribute 'default nil :font "Inconsolata-14")
       (set-face-attribute 'default nil :font "Monaco-15" :weight 'bold)
  ;    (set-face-attribute 'default nil :font "Hack-16")
  ;    (set-face-attribute 'default nil :font "DejaVu Sans Mono-16")
    (set-face-attribute 'default nil :font "DejaVu Sans Mono" :height 110))

  ;; set italic font for italic face, since Emacs does not set italic
  ;; face automatically
  (set-face-attribute 'italic nil
                      :family "Hack-Italic")
#+END_SRC
** highlight numbers
#+BEGIN_SRC emacs-lisp
(use-package highlight-numbers
:config
(add-hook 'prog-mode-hook 'highlight-numbers-mode))
#+END_SRC
** highlight symbol
#+BEGIN_SRC emacs-lisp
    (use-package highlight-symbol
    :config

    (require 'highlight-symbol)
    (highlight-symbol-nav-mode)
    (add-hook 'prog-mode-hook
              (lambda() (highlight-symbol-mode)))
    (add-hook 'org-mode-hook (lambda () (highlight-symbol-mode)))
  (setq highlight-symbol-idle-delay 0.2
        highlight-symbol-on-navigation-p t)

  (global-set-key [(control shift mouse-1)]
                  (lambda (event)
                    (interactive "e")
                    (goto-char (posn-point (event-start event)))
                    (highlight-symbol-at-point)))

  (global-set-key (kbd "M-n") 'highlight-symbol-next)
  (global-set-key (kbd "M-p") 'highlight-symbol-prev))
#+END_SRC
** whitespace mode
#+BEGIN_SRC emacs-lisp
  (use-package whitespace
    :bind ("C-c S-w" . whitespace-mode)
    :init
    (setq whitespace-line-column nil
          whitespace-display-mappings '((space-mark 32 [183] [46])
                                        (newline-mark 10 [9166 10])
                                        (tab-mark 9 [9654 9] [92 9])))
    :config
    (set-face-attribute 'whitespace-space       nil :foreground "#666666" :background nil)
    (set-face-attribute 'whitespace-newline     nil :foreground "#666666" :background nil)
    (set-face-attribute 'whitespace-indentation nil :foreground "#666666" :background nil)
    :diminish whitespace-mode)
#+END_SRC
* editing
** linum-mode
#+BEGIN_SRC emacs-lisp
  (add-hook 'prog-mode-hook 'linum-mode)
#+END_SRC
** delete-selection-mode

#+BEGIN_SRC emacs-lisp
(delete-selection-mode)
#+END_SRC
** newline-and-indent
#+begin_src emacs-lisp
(global-set-key (kbd "RET") 'newline-and-indent)
#+end_src
* try
#+begin_src emacs-lisp
(use-package try)
#+end_src
* workgroups2
- create your workspace in emacs
- saves all your opened buffers, their locations and sizes on disk to restore later
#+begin_src emacs-lisp
  (use-package workgroups2
  :config
  (require 'workgroups2)

  ;; Change prefix key (before activating WG)
  (setq wg-prefix-key (kbd "C-c z"))
  ;; Change workgroups session file
  (setq wg-session-file "~/.emacs.d/.emacs_workgroups")
  ;; What to do on Emacs exit / workgroups-mode exit?
  (setq wg-emacs-exit-save-behavior           'save)
  (setq wg-workgroups-mode-exit-save-behavior 'save)

  ;; Mode Line Changes
  ;; Display workgroups in Mode Line?
  (setq wg-mode-line-display-on t)
  (setq wg-flag-modified t)
  (setq wg-mode-line-decor-left-brace "["
        wg-mode-line-decor-right-brace "]"
        wg-mode-line-decor-divider ":")
  (workgroups-mode 1))
#+end_src
* hippie expand

hippe-expand is a better version of dabbrev-expand while dabbrev-expand searches for words you already types in current buffers and other buffers, hippie-expand includes more sources such as filenames, kill ring…
#+begin_src emacs-lisp
(global-set-key (kbd "M-/") 'hippie-expand) ;; replace dabbrev-expand
(setq
hippie-expand-try-functions-list
'(try-expand-dabbrev ;; Try to expand word "dynamically", searching the current buffer.
   try-expand-dabbrev-all-buffers ;; Try to expand word "dynamically", searching all other buffers.
   try-expand-dabbrev-from-kill ;; Try to expand word "dynamically", searching the kill ring.
   try-complete-file-name-partially ;; Try to complete text as a file name, as many characters as unique.
   try-complete-file-name ;; Try to complete text as a file name.
   try-expand-all-abbrevs ;; Try to expand word before point according to all abbrev tables.
   try-expand-list ;; Try to complete the current line to an entire line in the buffer.
   try-expand-line ;; Try to complete the current line to an entire line in the buffer.
   try-complete-lisp-symbol-partially ;; Try to complete as an Emacs Lisp symbol, as many characters as unique.
   try-complete-lisp-symbol) ;; Try to complete word as an Emacs Lisp symbol.
)
#+end_src
* kill this buffer
#+begin_src emacs-lisp
(global-set-key (kbd "C-x k") 'kill-this-buffer)
#+end_src
* auto-complete
#+begin_src emacs-lisp
(use-package auto-complete
:config
(require 'auto-complete-config)
(ac-config-default)
(setq ac-show-menu-immediately-on-auto-complete t))
#+end_src
* expand region
#+begin_src emacs-lisp
(use-package expand-region
:config
(require 'expand-region)
(global-set-key (kbd "M-m") 'er/expand-region))
#+end_src
* bm = Bookmarks Manager
#+begin_src emacs-lisp
(use-package bm
  :bind (("C-c =" . bm-toggle)
         ("C-c [" . bm-previous)
         ("C-c ]" . bm-next)))
#+end_src
* windows management :DRILL:
#+begin_src emacs-lisp
(use-package ace-window
:init
(progn
(setq aw-scope 'frame)
(global-set-key (kbd "C-x O") 'other-frame)
  (setq aw-keys '(?a ?s ?d ?f ?j ?k ?l ?o))
  (global-set-key [remap other-window] 'ace-window)
  (custom-set-faces
   '(aw-leading-char-face
     ((t (:inherit ace-jump-face-foreground :height 3.0)))))
  ))

(use-package ace-jump-mode
  :config
  (define-key global-map (kbd "C-c SPC") 'ace-jump-mode))
#+end_src
* indent whole buffer :DRILL:
#+begin_src emacs-lisp
(defun iwb ()
  "indent whole buffer"
  (interactive)
  (delete-trailing-whitespace)
  (indent-region (point-min) (point-max) nil)
  (untabify (point-min) (point-max)))

(global-set-key (kbd "C-c n") 'iwb)
#+end_src
* command log mode :DRILL:
#+begin_src emacs-lisp
(use-package command-log-mode)
#+end_src
* zygospore

zygospore lets you revert C-x 1 (delete-other-window) by pressing C-x 1 again
[[https://github.com/LouisKottmann/zygospore.el/raw/master/demo.gif]]
#+begin_src emacs-lisp
(use-package zygospore
  :bind (("C-x 1" . zygospore-toggle-delete-other-windows)
         ("RET" .   newline-and-indent)))
#+end_src

* origami :DRILL:
#+begin_src emacs-lisp
(use-package origami
:ensure t
:config
(require 'origami)
(add-hook 'prog-mode-hook 'origami-mode)
(define-key origami-mode-map (kbd "C-c f") 'origami-recursively-toggle-node)
(define-key origami-mode-map (kbd "C-c F") 'origami-toggle-all-nodes))
#+end_src
* duplicate thing
#+begin_src emacs-lisp
(use-package duplicate-thing
:ensure t
:config
(require 'duplicate-thing)
(global-set-key (kbd "M-c") 'duplicate-thing))
#+end_src
* smartparens :DRILL:
#+begin_src emacs-lisp
(use-package smartparens-config
:ensure smartparens
:config
(progn
(show-smartparens-global-mode t)))

(add-hook 'prog-mode-hook 'turn-on-smartparens-strict-mode)
;(add-hook 'markdown-mode-hook 'turn-on-smartparens-strict-mode)
(bind-keys
 :map smartparens-mode-map
 ("C-M-a" . sp-beginning-of-sexp)
 ("C-M-e" . sp-end-of-sexp)

 ("C-<down>" . sp-down-sexp)
 ("C-<up>"   . sp-up-sexp)
 ("M-<down>" . sp-backward-down-sexp)
 ("M-<up>"   . sp-backward-up-sexp)

 ("C-M-f" . sp-forward-sexp)
 ("C-M-b" . sp-backward-sexp)

 ("C-M-n" . sp-next-sexp)
 ("C-M-p" . sp-previous-sexp)

 ("C-S-f" . sp-forward-symbol)
 ("C-S-b" . sp-backward-symbol)

 ("C-<right>" . sp-forward-slurp-sexp)
 ("M-<right>" . sp-forward-barf-sexp)
 ("C-<left>"  . sp-backward-slurp-sexp)
 ("M-<left>"  . sp-backward-barf-sexp)

 ("C-M-t" . sp-transpose-sexp)
 ("C-M-k" . sp-kill-sexp)
 ("C-k"   . sp-kill-hybrid-sexp)
 ("M-k"   . sp-backward-kill-sexp)
 ("C-M-w" . sp-copy-sexp)
 ("C-M-d" . delete-sexp)

 ("M-<backspace>" . backward-kill-word)
 ("C-<backspace>" . sp-backward-kill-word)
 ([remap sp-backward-kill-word] . backward-kill-word)

 ("M-[" . sp-backward-unwrap-sexp)
 ("M-]" . sp-unwrap-sexp)

 ("C-x C-t" . sp-transpose-hybrid-sexp)

 ("C-c ("  . wrap-with-parens)
 ("C-c ["  . wrap-with-brackets)
 ("C-c {"  . wrap-with-braces)
 ("C-c M-'"  . wrap-with-single-quotes)
 ("C-c \"" . wrap-with-double-quotes)
 ("C-c _"  . wrap-with-underscores)
 ("C-c `"  . wrap-with-back-quotes))
#+end_src
* which-mode
#+begin_src emacs-lisp
(use-package which-key
  :ensure t
  :diminish which-key-mode
  :config
  (which-key-mode))
#+end_src
* undo-tree

undo-tree allows you to visual the whole history of your editing in a tree. 
It also provides regular undo/redo behaviours in other editors. 
undo-tree can even provide a diff between two different states. 
Highly recommended.

[[https://camo.githubusercontent.com/85240e7df44ee70d29d68187e15d7a8a37291c4a/68747470733a2f2f747568646f2e6769746875622e696f2f7374617469632f70617274332f756e646f2d747265652e6a7067]]

#+begin_src emacs-lisp
  (use-package undo-tree
    :ensure t
    :diminish undo-tree-mode
    :init
    (global-undo-tree-mode 1)
    :config
    (defalias 'redo 'undo-tree-redo)
    (require 'undo-tree)
    :bind (("C-z" . undo)
           ("C-S-z" . redo)))
#+end_src

* yasnippet
#+begin_src emacs-lisp
(use-package yasnippet
:ensure t
:config
(require 'yasnippet)
(yas-global-mode 1))
#+end_src
* vimish fold
#+begin_src emacs-lisp
(use-package vimish-fold)

(require 'vimish-fold)
(vimish-fold-global-mode 1)
;; this registers a region for future folding/unfolding
(global-set-key (kbd "C-c v") #'vimish-fold)
;; this unregisters the region under point from folding/unfolding
(global-set-key (kbd "C-c d") #'vimish-fold-delete)
;; this is the actual fold/unfold command
(global-set-key (kbd "C-c t") #'vimish-fold-toggle)
#+end_src
* multiple-cursor :DRILL:
#+begin_src emacs-lisp 
  (use-package multiple-cursors
    :config
    (require 'multiple-cursors)
    (global-set-key (kbd "C-S-c C-S-c") 'mc/edit-lines)
    (global-set-key (kbd "C->") 'mc/mark-next-like-this)
    (global-set-key (kbd "C-<") 'mc/mark-previous-like-this)
    (global-set-key (kbd "C-c C-<") 'mc/mark-all-like-this))
#+end_src
* frequent file shortcuts
#+BEGIN_SRC emacs-lisp
  (global-set-key
   (kbd "\e\ec")
   (lambda()
     (interactive)
     (find-file "~/.emacs.d/README.org")))
#+END_SRC
* projectile :DRILL:

- jump to a file in project
- jump to a directory in a project
- jump to file in a dir
- jump to a project buffer
- jump to a test in project
- toggle between code and its test
- jump to recently visited files in the project
- switch between projects you have worked on
- kill all project buffers
- replace in project
- multi-occur in project buffers
- grep in project
- regenerate project etags or gtags
- visit project in dired
- run make in a project with a single key chord
- check for dirty repos

Some Helpful Commands
C-c p s Switch to project
C-c p f List files in project
C-c p k Kill all buffers for project

#+begin_src emacs-lisp
(use-package projectile
:config
(projectile-global-mode))
#+end_src

* ORG
** global settings
#+begin_src emacs-lisp
  (setq
   org-directory "~/Dropbox/org"
   org-default-notes-file (concat org-directory "/notes.org")
   org-export-html-postamble nil
   org-hide-leading-stars t
   org-startup-folded (quote overview)
   org-startup-indented t
   )
#+end_src
** code-block shortcuts
ref: sacha
#+BEGIN_SRC emacs-lisp
(setq org-structure-template-alist
      '(("s" "#+begin_src ?\n\n#+end_src" "<src lang=\"?\">\n\n</src>")
        ("e" "#+begin_example\n?\n#+end_example" "<example>\n?\n</example>")
        ("q" "#+begin_quote\n?\n#+end_quote" "<quote>\n?\n</quote>")
        ("v" "#+BEGIN_VERSE\n?\n#+END_VERSE" "<verse>\n?\n</verse>")
        ("l" "#+begin_src emacs-lisp\n?\n#+end_src" "<src lang=\"emacs-lisp\">\n?\n</src>")
        ("p" "#+begin_src python\n?\n#+end_src" "<src lang=\"python\">\n?\n</src>")
        ("c" "#+begin_src cpp\n?\n#+end_src" "<src lang=\"cpp\">\n?\n</src>")
        ("L" "#+latex: " "<literal style=\"latex\">?</literal>")
        ("h" "#+begin_html\n?\n#+end_html" "<literal style=\"html\">\n?\n</literal>")
        ("H" "#+html: " "<literal style=\"html\">?</literal>")
        ("a" "#+begin_ascii\n?\n#+end_ascii")
        ("A" "#+ascii: ")
        ("i" "#+index: ?" "#+index: ?")
        ("I" "#+include %file ?" "<include file=%file markup=\"?\">")))
#+END_SRC
** htmlize
#+begin_src emacs-lisp
(use-package htmlize)
#+end_src
** reveal.js
#+begin_src emacs-lisp
(use-package ox-reveal)

(setq org-reveal-root "http://cdn.jsdelivr.net/reveal.js/3.0.0/")
(setq org-reveal-mathjax t)
#+end_src
** org agenda
#+begin_src emacs-lisp
    (global-set-key "\C-ca" 'org-agenda)

    (setq org-agenda-custom-commands
          '(
            (
             "c"
             "Simple agenda view"
             (
              (agenda "")
              (alltodo "")
              )
             )
            )
          )

    (setq org-agenda-files
          (
           list
           "~/Dropbox/org/gcal.org"
           "~/Dropbox/org/schedule.org"
           "~/Dropbox/org/todo.org"
           "~/Dropbox/org/links.org"
           "~/Dropbox/org/index.org"
           )
          )
#+end_src
** org-ac = Auto Complete Org Mode
#+begin_src emacs-lisp
(use-package org-ac
      :init (progn
              (require 'org-ac)
              (org-ac/config-default)
              ))
#+end_src
** org-capture
#+begin_src emacs-lisp
(global-set-key
(kbd "C-c c")
'org-capture)

(setq
 org-capture-templates
 '(
   ("j" "Journal" entry (file "~/Dropbox/org/journal.org")
    "* %t\n** Day\n*** What am I Grateful For:\n1. %?\n2. \n3. \n*** What Would Make Today Great:\n1. \n2. \n3. \n*** Daily Affirmations I am:\n1. \n2. \n3. \n\n** Night\n*** 3 Amazing Things Happened Today:\n1. \n2. \n3. \n*** How could I Make Things Better\n1. \n2. \n3. \n" :prepend t)
   ("l" "Link" entry (file "~/Dropbox/org/links.org")
    "* %?%^L %^g \n%T" :prepend t)
   ("t" "Todo" entry (file "~/Dropbox/org/todo.org")
    "* TODO %?\n%u%T" :prepend t)
   ("n" "Notes" entry (file "~/Dropbox/org/notes.org")
    "* %?\n%u" :prepend t)
   ))
#+end_src
** set-default-browser
#+begin_src emacs-lisp
(setq browse-url-browser-function 'browse-url-generic
      browse-url-generic-program "google-chrome")
#+end_src
** open pdf in evince
#+begin_src emacs-lisp
(setq org-file-apps
      (append '(
                ("\\.pdf\\'" . "evince %s")
                ) org-file-apps ))
#+end_src
** org bullets
#+begin_src emacs-lisp
(use-package org-bullets
  :config
  (add-hook 'org-mode-hook
            (lambda () (org-bullets-mode 1))))
#+end_src
** literate programming

don't create a new window each time
#+begin_src emacs-lisp
(setq org-src-window-setup 'current-window)
#+end_src

use C-x C-s for closing out of the org-src-edit buffer
#+begin_src emacs-lisp
  (eval-after-load 'org-src
    '(define-key org-src-mode-map
       (kbd "C-x C-s") #'org-edit-src-exit))
#+end_src
* MAGIT

#+begin_src emacs-lisp
(use-package magit
  :commands magit-status magit-blame
  :init
  (defadvice magit-status (around magit-fullscreen activate)
    (window-configuration-to-register :magit-fullscreen)
    ad-do-it
    (delete-other-windows))
  :config
  (setq vc-follow-symlinks nil
        magit-push-always-verify nil
        magit-restore-window-configuration t)
  :bind ("C-x g" . magit-status))
#+end_src
* HELM
#+begin_src emacs-lisp
    (use-package helm
    :diminish helm-mode
    ;; :init
    ;; (setq helm-idle-delay 0.0
    ;;       helm-input-idle-delay 0.01
    ;;       helm-yas-display-key-on-candidate t
    ;;       helm-quick-update t
    ;;       helm-M-x-requires-pattern nil
    ;;       helm-ff-skip-boring-files t)
    ;; (helm-mode)
    :ensure t)

    (require 'helm)
    (require 'helm-config)

    ;; The default "C-x c" is quite close to "C-x C-c", which quits Emacs
    ;; Change to "C-c h"
    (global-set-key (kbd "C-c h") 'helm-command-prefix)
    (global-unset-key (kbd "C-x c"))
    (global-set-key (kbd "M-x") #'helm-M-x)
    (global-set-key (kbd "C-x r b") #'helm-filtered-bookmarks)
    (global-set-key (kbd "C-x C-f") #'helm-find-files)
    (global-set-key (kbd "M-y") 'helm-show-kill-ring)
    (global-set-key (kbd "C-x b") 'helm-mini)
    (global-set-key (kbd "C-c h o") 'helm-occur)
    ; rebind tab to run persistent action
    (define-key helm-map (kbd "<tab>") 'helm-execute-persistent-action)
    ; make TAB work in terminal
    (define-key helm-map (kbd "C-i") 'helm-execute-persistent-action)
    ; list actions using C-z
    (define-key helm-map (kbd "C-z")  'helm-select-action)

    (when (executable-find "curl")
      (setq helm-google-suggest-use-curl-p t))

    (setq helm-split-window-in-side-p       t ; open helm buffer inside current window, not occupy whole other window
      helm-move-to-line-cycle-in-source     t ; move to end or beginning of source when reaching top or bottom of source.
      helm-ff-search-library-in-sexp        t ; search for library in `require' and `declare-function' sexp.
      helm-scroll-amount                    8 ; scroll 8 lines other window using M-<next>/M-<prior>
      helm-ff-file-name-history-use-recentf t
      helm-echo-input-in-header-line t)

    (defun spacemacs//helm-hide-minibuffer-maybe ()
      "Hide minibuffer in Helm session if we use the header line as input field."
      (when (with-helm-buffer helm-echo-input-in-header-line)
        (let ((ov (make-overlay (point-min) (point-max) nil nil t)))
          (overlay-put ov 'window (selected-window))
          (overlay-put ov 'face
                       (let ((bg-color (face-background 'default nil)))
                         `(:background ,bg-color :foreground ,bg-color)))
          (setq-local cursor-type nil))))

    (add-hook 'helm-minibuffer-set-up-hook
              'spacemacs//helm-hide-minibuffer-maybe)

    (defun pl/helm-alive-p ()
      (if (boundp 'helm-alive-p)
          (symbol-value 'helm-alive-p)))

  ;  (add-to-list 'golden-ratio-inhibit-functions 'pl/helm-alive-p)

    (setq helm-M-x-fuzzy-match t) ;; optional fuzzy matching for helm-M-x
    (setq helm-buffers-fuzzy-matching t
        helm-recentf-fuzzy-match    t)
    (setq helm-autoresize-max-height 0)
    (setq helm-autoresize-min-height 20)
    (helm-autoresize-mode 1)
    (helm-mode 1)

    (when (executable-find "ack-grep")
      (setq helm-grep-default-command "ack-grep -Hn --no-group --no-color %e %p %f"
            helm-grep-default-recurse-command "ack-grep -H --no-group --no-color %e %p %f"))
    (setq helm-locate-fuzzy-match t)
    (setq helm-apropos-fuzzy-match t)
#+end_src

helm-descbinds
#+begin_src emacs-lisp
(use-package helm-descbinds
  :defer t
  :bind(
        ("C-h b" . helm-descbinds)
        ("C-h w" . helm-descbinds)))
#+end_src

Helm Projectile
#+begin_src emacs-lisp
(projectile-global-mode)
(setq projectile-completion-system 'helm)
(helm-projectile-on)
#+end_src
* PROGRAMMING
** emacs-lisp
** python

IDE Features I will Need
- easily find files and switch between projects
- easy navigating through function definition
- contexual documentation
- inline help for function calls

Ref: [[https://youtu.be/6BlTGPsjGJk]]

Required packages
- projectile 
- auto-complete
- epc
- jedi
*** __init__
#+begin_src emacs-lisp
(add-hook 'python-mode-hook
          (lambda ()
            (setq indent-tabs-mode nil)
            (setq tab-width 4)
            (setq python-indent-offset 4)))

;(setq py-python-command "python3")
(setq python-shell-interpreter "ipython3" python-shell-interpreter-args "--simple-prompt --pprint")

; use the wx backend, for both mayavi and matplotlib
;(setq py-python-command-args
;  '("--gui=wx" "--pylab=wx" "-colors" "Linux"))
;(setq py-force-py-shell-name-p t)

; switch to the interpreter after executing code
(setq py-shell-switch-buffers-on-execute-p t)
(setq py-switch-buffers-on-execute-p t)
; don't split windows
(setq py-split-windows-on-execute-p nil)
; try to automagically figure out indentation
(setq py-smart-indentation t)
#+end_src

#+begin_src bash
#sudo apt install -y python3-rope \
#                   python3-isort
#sudo pip3 install flake8 jedi autopep8 yapf importmagic
#+end_src
*** elpy
#+begin_src emacs-lisp
(use-package elpy
:ensure t
:config
(elpy-enable)
(setq elpy-rpc-python-command "python3"))
#+end_src
*** flycheck
#+begin_src emacs-lisp
(use-package flycheck
:ensure t
:config
(when (require 'flycheck nil t)
  (setq elpy-modules (delq 'elpy-module-flymake elpy-modules))
  (add-hook 'elpy-mode-hook 'flycheck-mode)))
#+end_src
*** py-autopep8
#+begin_src emacs-lisp
(use-package py-autopep8
:ensure t
:config
(require 'py-autopep8)
(add-hook 'elpy-mode-hook 'py-autopep8-enable-on-save))
#+end_src
*** Ipython/Jupyter
#+begin_src emacs-lisp
;(setq-default py-shell-name "ipython3")
; (setq-default py-which-bufname "Ipython3")
(elpy-use-ipython "ipython3")

;; needs to work on this snippet
;; not enough time
;; probably let yourself know why jupyter is used?
(use-package ein
:ensure t)
#+end_src
*** anaconda
#+begin_src emacs-lisp
(use-package anaconda-mode
:ensure t
:config
(add-hook 'python-mode-hook 'anaconda-mode)
(add-hook 'python-mode-hook 'anaconda-eldoc-mode))
#+end_src
*** epc
#+begin_src emacs-lisp
(use-package epc)
#+end_src
*** jedi 
#+begin_src emacs-lisp
  (use-package jedi
  :config
  (require 'jedi))

  ;; Global Jedi config vars

  (defvar jedi-config:use-system-python nil
    "Will use system python and active environment for Jedi server.
  May be necessary for some GUI environments (e.g., Mac OS X)")

  (defvar jedi-config:with-virtualenv nil
    "Set to non-nil to point to a particular virtualenv.")

  (defvar jedi-config:vcs-root-sentinel ".git")

  (defvar jedi-config:python-module-sentinel "__init__.py")


  ;; Helper functions

  ;; Small helper to scrape text from shell output
  (defun get-shell-output (cmd)
    (replace-regexp-in-string "[ \t\n]*$" "" (shell-command-to-string cmd)))

  ;; Ensure that PATH is taken from shell
  ;; Necessary on some environments without virtualenv
  ;; Taken from: http://stackoverflow.com/questions/8606954/path-and-exec-path-set-but-emacs-does-not-find-executable

  (defun set-exec-path-from-shell-PATH ()
    "Set up Emacs' `exec-path' and PATH environment variable to match that used by the user's shell."
    (interactive)
    (let ((path-from-shell (get-shell-output "$SHELL --login -i -c 'echo $PATH'")))
      (setenv "PATH" path-from-shell)
      (setq exec-path (split-string path-from-shell path-separator))))

  (defun get-project-root-with-file (buf repo-file &optional init-file)
        "Guesses that the python root is the less 'deep' of either:
           -- the root directory of the repository, or
           -- the directory before the first directory after the root
              having the init-file file (e.g., '__init__.py'."

        ;; make list of directories from root, removing empty
        (defun make-dir-list (path)
          (delq nil (mapcar (lambda (x) (and (not (string= x "")) x))
                            (split-string path "/"))))
        ;; convert a list of directories to a path starting at "/"
        (defun dir-list-to-path (dirs)
          (mapconcat 'identity (cons "" dirs) "/"))
        ;; a little something to try to find the "best" root directory
        (defun try-find-best-root (base-dir buffer-dir current)
          (cond
           (base-dir ;; traverse until we reach the base
            (try-find-best-root (cdr base-dir) (cdr buffer-dir)
                                (append current (list (car buffer-dir)))))

           (buffer-dir ;; try until we hit the current directory
            (let* ((next-dir (append current (list (car buffer-dir))))
                   (file-file (concat (dir-list-to-path next-dir) "/" init-file)))
              (if (file-exists-p file-file)
                  (dir-list-to-path current)
                (try-find-best-root nil (cdr buffer-dir) next-dir))))

           (t nil)))

        (let* ((buffer-dir (expand-file-name (file-name-directory (buffer-file-name buf))))
               (vc-root-dir (vc-find-root buffer-dir repo-file)))
          (if (and init-file vc-root-dir)
              (try-find-best-root
               (make-dir-list (expand-file-name vc-root-dir))
               (make-dir-list buffer-dir)
               '())
            vc-root-dir))) ;; default to vc root if init file not given

      ;; Set this variable to find project root
      (defvar jedi-config:find-root-function 'get-project-root-with-file)

      (defun current-buffer-project-root ()
        (funcall jedi-config:find-root-function
                 (current-buffer)
                 jedi-config:vcs-root-sentinel
                 jedi-config:python-module-sentinel))

      (defun jedi-config:setup-server-args ()
        ;; little helper macro for building the arglist
        (defmacro add-args (arg-list arg-name arg-value)
          `(setq ,arg-list (append ,arg-list (list ,arg-name ,arg-value))))
        ;; and now define the args
        (let ((project-root (current-buffer-project-root)))

          (make-local-variable 'jedi:server-args)

          (when project-root
            (message (format "Adding system path: %s" project-root))
            (add-args jedi:server-args "--sys-path" project-root))

          (when jedi-config:with-virtualenv
            (message (format "Adding virtualenv: %s" jedi-config:with-virtualenv))
            (add-args jedi:server-args "--virtual-env" jedi-config:with-virtualenv))))

      ;; Use system python
      (defun jedi-config:set-python-executable ()
        (set-exec-path-from-shell-PATH)
        (make-local-variable 'jedi:server-command)
        (set 'jedi:server-command
             (list (executable-find "python") ;; may need help if running from GUI
                   (cadr default-jedi-server-command))))

      ;; Now hook everything up
      ;; Hook up to autocomplete
      (add-to-list 'ac-sources 'ac-source-jedi-direct)

      ;; Enable Jedi setup on mode start
      (add-hook 'python-mode-hook 'jedi:setup)

      ;; Buffer-specific server options
      (add-hook 'python-mode-hook
                'jedi-config:setup-server-args)
      (when jedi-config:use-system-python
        (add-hook 'python-mode-hook
                  'jedi-config:set-python-executable))

      ;; And custom keybindings
      (defun jedi-config:setup-keys ()
        (local-set-key (kbd "M-.") 'jedi:goto-definition)
        (local-set-key (kbd "M-,") 'jedi:goto-definition-pop-marker)
        (local-set-key (kbd "M-?") 'jedi:show-doc)
        (local-set-key (kbd "M-/") 'jedi:get-in-function-call))

      ;; Don't let tooltip show up automatically
      (setq jedi:get-in-function-call-delay 10000000)
      ;; Start completion at method dot
      (setq jedi:complete-on-dot t)
      ;; Use custom keybinds
      (add-hook 'python-mode-hook 'jedi-config:setup-keys)
#+end_src
